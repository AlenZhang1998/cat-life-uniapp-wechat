{"version":3,"file":"personal-info.js","sources":["pages/profile/personal-info.vue","../../../App/hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9wZXJzb25hbC1pbmZvLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"personal-info-page\">\r\n    <view class=\"form-card\">\r\n      <view class=\"avatar-section\">\r\n        <view class=\"avatar-preview\" @tap=\"chooseAvatar\">\r\n          <image v-if=\"form.avatar\" :src=\"form.avatar\" mode=\"aspectFill\" />\r\n          <text v-else>添加头像</text>\r\n        </view>\r\n        <text class=\"avatar-tip\">支持拍照或从本地相册选择</text>\r\n        <button class=\"avatar-btn\" @tap=\"chooseAvatar\">更换头像</button>\r\n      </view>\r\n\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">昵称</text>\r\n        <input class=\"form-input\" v-model=\"form.name\" placeholder=\"请输入昵称\" maxlength=\"20\" />\r\n      </view>\r\n\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">性别</text>\r\n        <picker mode=\"selector\" :range=\"genderOptions\" :value=\"genderIndex\" @change=\"onGenderChange\">\r\n          <view class=\"picker-value\">{{ form.gender || '请选择性别' }}</view>\r\n        </picker>\r\n      </view>\r\n\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">提车日期</text>\r\n        <picker mode=\"date\" :value=\"form.deliveryDate\" @change=\"onDeliveryChange\">\r\n          <view class=\"picker-value\">{{ form.deliveryDate || '请选择提车日期' }}</view>\r\n        </picker>\r\n      </view>\r\n\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">爱车型号</text>\r\n        <input class=\"form-input\" v-model=\"form.carModel\" placeholder=\"请输入你喜欢的车型\" maxlength=\"30\" />\r\n      </view>\r\n\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">联系电话</text>\r\n        <input class=\"form-input\" v-model=\"form.phone\" placeholder=\"请输入手机号\" type=\"number\" maxlength=\"11\" />\r\n      </view>\r\n\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">邮箱</text>\r\n        <input class=\"form-input\" v-model=\"form.email\" placeholder=\"请输入邮箱地址\" type=\"text\" />\r\n      </view>\r\n    </view>\r\n\r\n    <button class=\"save-btn\" @tap=\"handleSave\">保存</button>\r\n  </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { useAuth } from '@/utils/auth'\n\r\ninterface UserProfile {\r\n  avatar: string\r\n  name: string\r\n  gender: string\r\n  deliveryDate: string\r\n  carModel: string\r\n  phone: string\r\n  email: string\r\n}\r\n\r\nconst genderOptions = ['男', '女', '保密']\r\n\r\nconst form = ref<UserProfile>({\r\n  avatar: '',\r\n  name: '',\r\n  gender: '保密',\r\n  deliveryDate: '',\r\n  carModel: '',\r\n  phone: '',\r\n  email: ''\r\n})\r\n\r\nconst genderIndex = ref(2)\nconst { refreshLoginState } = useAuth()\n\r\nconst syncGenderIndex = (value: string) => {\r\n  const idx = genderOptions.indexOf(value)\r\n  genderIndex.value = idx >= 0 ? idx : 2\r\n}\r\n\r\nconst loadProfile = () => {\r\n  try {\r\n    const stored = uni.getStorageSync('userProfile')\r\n    if (stored) {\r\n      const profile = (typeof stored === 'string' ? JSON.parse(stored) : stored) as Partial<UserProfile> & {\r\n        birthDate?: string\r\n      }\r\n      if (!profile.deliveryDate && profile.birthDate) {\r\n        profile.deliveryDate = profile.birthDate\r\n      }\r\n      form.value = { ...form.value, ...profile }\r\n      syncGenderIndex(form.value.gender || '保密')\r\n    }\r\n  } catch (error) {\r\n    uni.__f__('warn','at pages/profile/personal-info.vue:101','加载个人信息失败', error)\r\n  }\r\n}\r\n\r\nonLoad(() => {\r\n  loadProfile()\r\n})\r\n\r\nconst onGenderChange = (event: any) => {\r\n  const idx = Number(event.detail.value)\r\n  genderIndex.value = idx\r\n  form.value.gender = genderOptions[idx]\r\n}\r\n\r\nconst onDeliveryChange = (event: any) => {\r\n  form.value.deliveryDate = event.detail.value\r\n}\r\n\r\nconst chooseAvatar = () => {\r\n  uni.showActionSheet({\r\n    itemList: ['拍照', '从相册选择'],\r\n    success: ({ tapIndex }) => {\r\n      const sourceType = tapIndex === 0 ? 'camera' : 'album'\r\n      pickAvatar(sourceType)\r\n    }\r\n  })\r\n}\r\n\r\nconst pickAvatar = (sourceType: 'camera' | 'album') => {\r\n  uni.chooseImage({\r\n    count: 1,\r\n    sizeType: ['compressed'],\r\n    sourceType: [sourceType],\r\n    success: (res) => {\r\n      form.value.avatar = res.tempFilePaths[0]\r\n    }\r\n  })\r\n}\r\n\r\nconst handleSave = () => {\r\n  if (!form.value.name || !form.value.carModel || !form.value.deliveryDate) {\r\n    uni.showToast({\r\n      title: !form.value.name ? '请填写昵称' : !form.value.carModel ? '请填写爱车型号' : '请选择提车日期',\r\n      icon: 'none'\r\n    })\r\n    return\r\n  }\r\n\r\n  try {\n    uni.setStorageSync('userProfile', { ...form.value })\n    refreshLoginState()\n    uni.showToast({\n      title: '已保存',\n      icon: 'success'\n    })\r\n    setTimeout(() => {\r\n      uni.navigateBack()\r\n    }, 500)\r\n  } catch (error) {\r\n    uni.showToast({\r\n      title: '保存失败，请稍后再试',\r\n      icon: 'none'\r\n    })\r\n    uni.__f__('error','at pages/profile/personal-info.vue:164','保存个人信息失败', error)\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/uni.scss';\r\n\r\n.personal-info-page {\r\n  min-height: 100vh;\r\n  background: #f5f7fb;\r\n  padding: 32rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.form-card {\r\n  background: #fff;\r\n  border-radius: 32rpx;\r\n  padding: 36rpx;\r\n  box-shadow: 0 12rpx 40rpx rgba(44, 89, 140, 0.08);\r\n}\r\n\r\n.avatar-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.avatar-preview {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  border-radius: 50%;\r\n  background: #f2f4f8;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 28rpx;\r\n  color: #96a0b5;\r\n  overflow: hidden;\r\n}\r\n\r\n.avatar-preview image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.avatar-tip {\r\n  font-size: 24rpx;\r\n  color: #8b94a8;\r\n  margin-top: 16rpx;\r\n}\r\n\r\n.avatar-btn {\r\n  margin-top: 20rpx;\r\n  width: 240rpx;\r\n  height: 68rpx;\r\n  line-height: 68rpx;\r\n  border-radius: 999rpx;\r\n  background: linear-gradient(90deg, #3ed08c, #2eb872);\r\n  color: #fff;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.form-group {\r\n  margin-top: 28rpx;\r\n}\r\n\r\n.form-label {\r\n  font-size: 28rpx;\r\n  color: #5a6276;\r\n  margin-bottom: 12rpx;\r\n  display: block;\r\n}\r\n\r\n.form-input,\r\n.picker-value {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  border-radius: 20rpx;\r\n  background: #f5f7fb;\r\n  padding: 0 24rpx;\r\n  box-sizing: border-box;\r\n  font-size: 28rpx;\r\n  color: #2b3141;\r\n}\r\n\r\n.picker-value {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.save-btn {\r\n  margin-top: 36rpx;\r\n  width: 100%;\r\n  height: 92rpx;\r\n  line-height: 92rpx;\r\n  border-radius: 999rpx;\r\n  background: linear-gradient(90deg, #28d39d, #2cb4ff);\r\n  color: #fff;\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/Learn/projectFile/cat-life-uniapp-wechat/pages/profile/personal-info.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","useAuth","uni","onLoad"],"mappings":";;;;;;AAkEA,UAAM,gBAAgB,CAAC,KAAK,KAAK,IAAI;AAErC,UAAM,OAAOA,cAAAA,IAAiB;AAAA,MAC5B,QAAQ;AAAA,MACR,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,cAAc;AAAA,MACd,UAAU;AAAA,MACV,OAAO;AAAA,MACP,OAAO;AAAA,IAAA,CACR;AAEK,UAAA,cAAcA,kBAAI,CAAC;AACnB,UAAA,EAAE,sBAAsBC,WAAAA;AAExB,UAAA,kBAAkB,CAAC,UAAkB;AACnC,YAAA,MAAM,cAAc,QAAQ,KAAK;AAC3B,kBAAA,QAAQ,OAAO,IAAI,MAAM;AAAA,IAAA;AAGvC,UAAM,cAAc,MAAM;AACpB,UAAA;AACI,cAAA,SAASC,cAAAA,MAAI,eAAe,aAAa;AAC/C,YAAI,QAAQ;AACV,gBAAM,UAAW,OAAO,WAAW,WAAW,KAAK,MAAM,MAAM,IAAI;AAGnE,cAAI,CAAC,QAAQ,gBAAgB,QAAQ,WAAW;AAC9C,oBAAQ,eAAe,QAAQ;AAAA,UACjC;AACA,eAAK,QAAQ,EAAE,GAAG,KAAK,OAAO,GAAG;AACjB,0BAAA,KAAK,MAAM,UAAU,IAAI;AAAA,QAC3C;AAAA,eACO,OAAO;AACdA,sBAAA,MAAI,MAAM,QAAO,0CAAyC,YAAY,KAAK;AAAA,MAC7E;AAAA,IAAA;AAGFC,kBAAAA,OAAO,MAAM;AACC;IAAA,CACb;AAEK,UAAA,iBAAiB,CAAC,UAAe;AACrC,YAAM,MAAM,OAAO,MAAM,OAAO,KAAK;AACrC,kBAAY,QAAQ;AACf,WAAA,MAAM,SAAS,cAAc,GAAG;AAAA,IAAA;AAGjC,UAAA,mBAAmB,CAAC,UAAe;AAClC,WAAA,MAAM,eAAe,MAAM,OAAO;AAAA,IAAA;AAGzC,UAAM,eAAe,MAAM;AACzBD,oBAAAA,MAAI,gBAAgB;AAAA,QAClB,UAAU,CAAC,MAAM,OAAO;AAAA,QACxB,SAAS,CAAC,EAAE,eAAe;AACnB,gBAAA,aAAa,aAAa,IAAI,WAAW;AAC/C,qBAAW,UAAU;AAAA,QACvB;AAAA,MAAA,CACD;AAAA,IAAA;AAGG,UAAA,aAAa,CAAC,eAAmC;AACrDA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,QACP,UAAU,CAAC,YAAY;AAAA,QACvB,YAAY,CAAC,UAAU;AAAA,QACvB,SAAS,CAAC,QAAQ;AAChB,eAAK,MAAM,SAAS,IAAI,cAAc,CAAC;AAAA,QACzC;AAAA,MAAA,CACD;AAAA,IAAA;AAGH,UAAM,aAAa,MAAM;AACnB,UAAA,CAAC,KAAK,MAAM,QAAQ,CAAC,KAAK,MAAM,YAAY,CAAC,KAAK,MAAM,cAAc;AACxEA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO,CAAC,KAAK,MAAM,OAAO,UAAU,CAAC,KAAK,MAAM,WAAW,YAAY;AAAA,UACvE,MAAM;AAAA,QAAA,CACP;AACD;AAAA,MACF;AAEI,UAAA;AACFA,sBAAA,MAAI,eAAe,eAAe,EAAE,GAAG,KAAK,OAAO;AACjC;AAClBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AACD,mBAAW,MAAM;AACfA,wBAAA,MAAI,aAAa;AAAA,WAChB,GAAG;AAAA,eACC,OAAO;AACdA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AACDA,sBAAA,MAAI,MAAM,SAAQ,0CAAyC,YAAY,KAAK;AAAA,MAC9E;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnKF,GAAG,WAAW,eAAe;"}
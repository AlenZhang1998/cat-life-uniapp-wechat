{"version":3,"file":"index.js","sources":["pages/profile/index.vue","pages/profile/index.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"profile-page\">\n    <view class=\"identity-card\">\n      <view class=\"identity-glow\"></view>\n      <view class=\"identity-header\">\n        <view class=\"avatar-ring\" @tap=\"handleAvatarTap\">\n          <view class=\"avatar-core\">\n            <image v-if=\"user.avatar && isLoggedIn\" :src=\"user.avatar\" class=\"avatar-image\" mode=\"aspectFill\" />\n            <text v-else-if=\"isLoggedIn\">{{ user.initial }}</text>\n            <text v-else class=\"avatar-placeholder\">ÁÇπÊàëÁôªÂΩï</text>\n          </view>\n        </view>\n        <view class=\"identity-meta\" v-if=\"isLoggedIn\">\n          <text class=\"identity-label\">È©æÈ©∂Ê°£Ê°à</text>\n          <text class=\"user-name\">{{ user.name }}</text>\n          <text class=\"user-subtitle\">Âä†ÂÖ•‰∫é {{ user.joinDate }}</text>\n          <view class=\"user-tags\">\n            <text class=\"user-tag\" v-for=\"tag in user.tags\" :key=\"tag\">{{ tag }}</text>\n          </view>\n        </view>\n        <view class=\"identity-meta identity-meta--placeholder\" v-else>\n          <text class=\"identity-label\">Ê¨¢ËøéÊù•Âà∞È©æÈ©∂Ê°£Ê°à</text>\n          <text class=\"user-name\">ÁÇπÂáªÂ§¥ÂÉèÂæÆ‰ø°‰∏ÄÈîÆÁôªÂΩï</text>\n          <text class=\"user-subtitle\">Ëß£ÈîÅ‰∏™ÊÄßÂåñÊï∞ÊçÆ‰∏éÊúçÂä°</text>\n        </view>\n      </view>\n      <view class=\"identity-motto-card\" v-if=\"isLoggedIn\">\n        <text class=\"motto-label\">‰ªäÊó•ÂøÉÊÉÖ</text>\n        <text class=\"motto-text\">{{ user.motto }}</text>\n      </view>\n    </view>\n\n    <view class=\"garage-card\">\n      <view class=\"section-header\">\n        <text class=\"section-title\">Â∏∏Áî®Ê®°Âùó</text>\n        <text class=\"section-subtitle\">‰ΩìÈ™åËá™ÂÆö‰πâÈ©æÈ©∂Êó•Â∏∏</text>\n      </view>\n      <view class=\"feature-list\">\n        <view class=\"feature-item\" v-for=\"item in features\" :key=\"item.key\" @tap=\"handleFeatureTap(item)\">\n          <view class=\"feature-icon\">{{ item.icon }}</view>\n          <view class=\"feature-content\">\n            <text class=\"feature-title\">{{ item.title }}</text>\n            <text class=\"feature-desc\">{{ item.desc }}</text>\n          </view>\n          <text class=\"feature-arrow\">Ôπ•</text>\n        </view>\n      </view>\n    </view>\n  </view>\n  <LoginOverlay v-model:visible=\"showLoginSheet\" @login-success=\"handleLoginSuccess\" />\n  <BottomActionBar active=\"profile\" :is-logged-in=\"isLoggedIn\" @login-required=\"handleLoginRequired\" />\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\nimport BottomActionBar from '@/components/BottomActionBar.vue'\nimport LoginOverlay from '@/components/LoginOverlay.vue'\nimport { useAuth } from '@/utils/auth'\n\nconst defaultProfile = {\n  name: 'Alen',\n  initial: 'A',\n  avatar: '',\n  joinDate: '2024-08',\n  motto: 'ÁªôÊ≤πÈó®‰∏Ä‰∏™Êã•Êä±ÔºåËÆ©ÂüéÂ∏ÇÂ§ö‰∏ÄÁÇπÁªø„ÄÇ',\n  tags: ['ÂüéÂ∏ÇÊº´Ê∏∏ËÄÖ', 'ËäÇËÉΩËææ‰∫∫', 'Â§úË°åËÄÖ'],\n  gender: '',\n  deliveryDate: '',\n  carModel: '',\n  phone: '',\n  email: ''\n}\n\nconst { isLoggedIn, refreshLoginState } = useAuth()\nconst showLoginSheet = ref(false)\nconst user = ref({ ...defaultProfile })\n\nconst features = ref([\n  {\n    key: 'garage',\n    icon: 'üöó',\n    title: '‰∏™‰∫∫‰ø°ÊÅØ',\n    desc: 'ÁºñËæë‰∏™‰∫∫‰ø°ÊÅØ, Áà±ËΩ¶ÂûãÂè∑'\n  },\n  {\n    key: 'feedback',\n    icon: 'üí°',\n    title: 'Âª∫ËÆÆÂèçÈ¶à',\n    desc: 'ÂíåÊàë‰ª¨ËÅäËÅä‰Ω†ÁöÑÁÅµÊÑüÔºåÊåÅÁª≠‰ºòÂåñ‰ΩìÈ™å'\n  },\n  {\n    key: 'backup',\n    icon: '‚òÅÔ∏è',\n    title: 'Êï∞ÊçÆÂ§á‰ªΩ',\n    desc: 'ÂêåÊ≠•Âà∞‰∫ëÁ´ØÔºåÊç¢Êú∫Êó†Âøß'\n  },\n  { key: 'subscription', icon: 'üßä', title: 'ËÆ¢ÈòÖÊúçÂä°', desc: 'Êô∫È©æÂÆûÈ™åÂÆ§‰ΩìÈ™å‰∏≠' },\n  {\n    key: 'settings',\n    icon: '‚öôÔ∏è',\n    title: 'ËÆæÁΩÆ‰∏≠ÂøÉ',\n    desc: 'ËÆ¢ÈòÖÊèêÈÜí„ÄÅÈöêÁßÅÂÅèÂ•Ω„ÄÅ‰∏ÄÈîÆÂèçÈ¶à'\n  }\n])\n\nconst applyProfile = (profile?: Record<string, any>) => {\n  const merged = { ...defaultProfile, ...(profile || {}) }\n  merged.initial = merged.name ? merged.name.charAt(0) : defaultProfile.initial\n  user.value = merged\n}\n\n// ‰ªéÊú¨Âú∞ÁºìÂ≠òÈáåËØªÁî®Êà∑‰ø°ÊÅØ\nconst initUserFromStorage = () => {\n  try {\n    const stored = uni.getStorageSync('userProfile')\n    uni.__f__('log','at pages/profile/index.vue:117',117, 'stored', stored)\n    if (stored) {\n      applyProfile(typeof stored === 'string' ? JSON.parse(stored) : stored)\n    } else {\n      user.value = { ...defaultProfile }\n    }\n  } catch (error) {\n    uni.__f__('warn','at pages/profile/index.vue:124','ËØªÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•', error)\n    user.value = { ...defaultProfile }\n  }\n  refreshLoginState()\n}\n\nonShow(() => {\n  initUserFromStorage()\n})\n\nconst handleAvatarTap = () => {\n  if (isLoggedIn.value) {\n    return\n  }\n  showLoginSheet.value = true\n}\n\n\nconst handleLoginSuccess = (payload: { token: string; user: any }) => {\n  const { token, user: backendUser } = payload\n\n  // ÊääÂêéÁ´ØËøîÂõûÁöÑ user Êò†Â∞ÑÊàê‰Ω†È°µÈù¢Áî®ÁöÑÁªìÊûÑ\n  const finalProfile = {\n    ...defaultProfile,\n    name: backendUser.nickname || defaultProfile.name,\n    avatar: backendUser.avatarUrl || '',\n    // ‰Ω†ÂêéÈù¢ÂèØ‰ª•ÂÜçÂä†Ôºögender / deliveryDate / carModel Á≠â\n  }\n  uni.__f__('log','at pages/profile/index.vue:152',152, 'finalProfile = ', finalProfile)\n\n  // Â≠òÊú¨Âú∞ÔºåË∑ü initUserFromStorage ÂØπ‰∏ä\n  uni.setStorageSync('token', token)\n  uni.setStorageSync('userProfile', finalProfile)\n\n  applyProfile(finalProfile)\n  refreshLoginState()\n  showLoginSheet.value = false\n}\n\nconst handleLoginRequired = () => {\n  if (!isLoggedIn.value) {\n    showLoginSheet.value = true\n  }\n}\n\nconst handleFeatureTap = (item: { key: string }) => {\n  if (!isLoggedIn.value) {\n    showLoginSheet.value = true\n    return\n  }\n  if (item.key === 'garage') {\n    uni.navigateTo({\n      url: '/pages/profile/personal-info'\n    })\n    return\n  }\n  uni.showToast({\n    title: 'ÂäüËÉΩÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖ',\n    icon: 'none'\n  })\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '@/uni.scss';\n\n.profile-page {\n  padding: 32rpx 32rpx 160rpx;\n  background: linear-gradient(180deg, #f8fbff 0%, #eef4f7 100%);\n  color: #1f2329;\n}\n\n\n.identity-card {\n  position: relative;\n  border-radius: 44rpx;\n  padding: 44rpx 40rpx 36rpx;\n  background: linear-gradient(135deg, #ffffff 0%, #eef8ff 45%, #fdf1ff 100%);\n  box-shadow: 0 28rpx 60rpx rgba(74, 111, 160, 0.2);\n  overflow: hidden;\n  margin-bottom: 32rpx;\n}\n\n.identity-glow {\n  position: absolute;\n  inset: -60rpx;\n  background: radial-gradient(circle at 15% 15%, rgba(190, 225, 255, 0.7), transparent 60%),\n    radial-gradient(circle at 85% 5%, rgba(255, 203, 240, 0.55), transparent 50%),\n    radial-gradient(circle at 50% 80%, rgba(198, 248, 219, 0.5), transparent 55%);\n  filter: blur(8rpx);\n}\n\n.identity-header {\n  display: flex;\n  align-items: center;\n  gap: 24rpx;\n  position: relative;\n  z-index: 1;\n}\n\n.avatar-ring {\n  width: 140rpx;\n  height: 140rpx;\n  border-radius: 50%;\n  background: conic-gradient(#2ed97a, #52a1ff, #ffd976, #2ed97a);\n  padding: 8rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.avatar-core {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  background: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 48rpx;\n  font-weight: 700;\n  color: #1f2329;\n  box-shadow: inset 0 0 18rpx rgba(0, 0, 0, 0.06);\n}\n\n.avatar-image {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n\n.avatar-placeholder {\n  color: #94a2b8;\n  font-size: 28rpx;\n}\n\n\n\n.identity-meta {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 12rpx;\n}\n\n.identity-label {\n  font-size: 22rpx;\n  letter-spacing: 4rpx;\n  text-transform: uppercase;\n  color: rgba(0, 0, 0, 0.35);\n}\n\n.user-name {\n  font-size: 40rpx;\n  font-weight: 700;\n}\n\n.user-subtitle {\n  font-size: 26rpx;\n  color: #6a7283;\n}\n\n.user-tags {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12rpx;\n}\n\n.user-tag {\n  padding: 6rpx 18rpx;\n  border-radius: 999rpx;\n  background: rgba(30, 193, 95, 0.12);\n  font-size: 22rpx;\n  color: #1d7243;\n}\n\n// .identity-badge {\n//   width: 120rpx;\n//   border-radius: 24rpx;\n//   background: rgba(82, 161, 255, 0.12);\n//   text-align: center;\n//   padding: 12rpx 0;\n//   font-size: 24rpx;\n//   color: #2a61d1;\n// }\n\n.identity-meta--placeholder {\n  align-items: flex-start;\n  gap: 8rpx;\n}\n\n.identity-meta--placeholder .user-name {\n  font-size: 32rpx;\n  color: #2a61d1;\n}\n\n.identity-motto-card {\n  margin-top: 24rpx;\n  padding: 24rpx;\n  border-radius: 28rpx;\n  background: rgba(255, 255, 255, 0.85);\n  box-shadow: inset 0 0 0 1rpx rgba(255, 255, 255, 0.3), 0 12rpx 32rpx rgba(86, 126, 173, 0.14);\n  position: relative;\n  z-index: 1;\n}\n\n.motto-label {\n  font-size: 22rpx;\n  color: #7a8295;\n  margin-bottom: 8rpx;\n  display: block;\n}\n\n.motto-text {\n  font-size: 28rpx;\n  color: #3a3f4d;\n  line-height: 1.4;\n}\n\n.identity-action {\n  display: flex;\n  align-items: center;\n  background: rgba(255, 255, 255, 0.9);\n  border-radius: 28rpx;\n  padding: 24rpx 26rpx;\n  gap: 20rpx;\n  box-shadow: 0 12rpx 28rpx rgba(78, 120, 172, 0.18);\n}\n\n.action-icon {\n  width: 72rpx;\n  height: 72rpx;\n  border-radius: 20rpx;\n  background: rgba(46, 217, 122, 0.12);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 32rpx;\n  flex-shrink: 0;\n}\n\n.action-meta {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n}\n\n.action-label {\n  font-size: 30rpx;\n  font-weight: 600;\n}\n\n.action-desc {\n  font-size: 24rpx;\n  color: #8a93a0;\n}\n\n.action-arrow {\n  font-size: 32rpx;\n  color: #aab0c0;\n}\n\n.stats-panel,\n.journey-card,\n.garage-card {\n  border-radius: 32rpx;\n  padding: 32rpx;\n  background: #fff;\n  box-shadow: 0 20rpx 48rpx rgba(72, 117, 149, 0.12);\n  margin-bottom: 32rpx;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24rpx;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: 700;\n}\n\n.section-subtitle {\n  font-size: 24rpx;\n  color: #8a93a0;\n}\n\n\n.feature-list {\n  display: flex;\n  flex-direction: column;\n  border-radius: 28rpx;\n  overflow: hidden;\n  border: 1rpx solid rgba(164, 186, 211, 0.25);\n}\n\n.feature-item {\n  display: flex;\n  align-items: center;\n  gap: 20rpx;\n  padding: 26rpx;\n  background: #fbfdff;\n}\n\n.feature-item + .feature-item {\n  border-top: 1rpx solid rgba(223, 229, 238, 0.9);\n}\n\n.feature-icon {\n  width: 72rpx;\n  height: 72rpx;\n  border-radius: 20rpx;\n  background: rgba(30, 193, 95, 0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 34rpx;\n}\n\n.feature-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 6rpx;\n}\n\n.feature-title {\n  font-size: 30rpx;\n  font-weight: 600;\n}\n\n.feature-desc {\n  font-size: 24rpx;\n  color: #8a93a0;\n}\n\n.feature-arrow {\n  font-size: 32rpx;\n  color: #c0c5d2;\n}\n</style>\n","import MiniProgramPage from '/Users/alan2/Downloads/zm/cat-life-uniapp-wechat/pages/profile/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useAuth","ref","uni","onShow"],"mappings":"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"}
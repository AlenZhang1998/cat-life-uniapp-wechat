{"version":3,"file":"index.js","sources":["pages/records/index.vue","pages/records/index.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"records-page\">\n    <view\n      class=\"summary-panel animated-block animated-block--delay-0\"\n      :class=\"{ 'animated-block--visible': isPageAnimated }\"\n    >\n      <!-- <view class=\"summary-panel__bg summary-panel__bg--left\"></view>\n      <view class=\"summary-panel__bg summary-panel__bg--right\"></view> -->\n      <view class=\"summary-head\">\n        <picker\n          class=\"summary-picker\"\n          mode=\"selector\"\n          :range=\"yearOptions\"\n          :value=\"selectedYearIndex\"\n          @change=\"handleYearChange\"\n        >\n          <view class=\"summary-year\">\n            <text>{{ currentYear }}</text>\n            <text class=\"iconfont icon-youjiantou\"></text>\n          </view>\n        </picker>\n        <view class=\"summary-chip\">\n          {{ currentYear === '全部' ? '油耗概况' : '年度油耗概况' }}\n        </view>\n      </view>\n\n      <view class=\"summary-total\">\n        <text class=\"summary-total__value\">{{ summaryCard.totalAmount }}</text>\n        <text class=\"summary-total__label\">\n          {{ currentYear === '全部' ? '总花费' : '本年总花费' }}\n        </text>\n      </view>\n      <view class=\"summary-grid\">\n        <view class=\"summary-stat\">\n          <text class=\"summary-stat__label\">平均油耗</text>\n          <text class=\"summary-stat__value\">{{ summaryCard.avgFuel }}</text>\n        </view>\n        <view class=\"summary-stat\">\n          <text class=\"summary-stat__label\">平均油价</text>\n          <text class=\"summary-stat__value\">{{\n            summaryCard.pricePerLiter\n          }}</text>\n        </view>\n        <view class=\"summary-stat\">\n          <text class=\"summary-stat__label\">总里程</text>\n          <text class=\"summary-stat__value\">{{ summaryCard.mileage }}</text>\n        </view>\n      </view>\n    </view>\n\n    <view class=\"records-list\">\n      <template v-for=\"(entry, entryIndex) in visibleRecords\" :key=\"entry.id\">\n        <view\n          v-if=\"isRecordItem(entry)\"\n          hover-class=\"record-card__hover\"\n          :class=\"[\n            'record-card',\n            'list-animated',\n            { 'list-animated--visible': isPageAnimated },\n            {\n              'record-card--compact': entry.compact,\n              'record-card--alert': entry.highlight === 'danger',\n              'record-card--expanded': isExpanded(entry.id),\n            },\n          ]\"\n          :style=\"getListAnimatedStyle(entryIndex)\"\n          @tap=\"toggleRecord(entry)\"\n        >\n          <view class=\"record-card__top\">\n            <view class=\"record-date\">\n              <text class=\"record-date__value\">{{ entry.date }}</text>\n            </view>\n            <view class=\"record-consumption\" v-if=\"entry.consumption !== '--'\">\n              <text\n                class=\"record-consumption__value\"\n                :class=\"{\n                  'record-consumption__value--high':\n                    Number(entry.consumption) > 9,\n                }\"\n              >\n                {{ entry.consumption }}\n              </text>\n              <text class=\"record-consumption__unit\">升/百公里</text>\n            </view>\n            <view class=\"record-mileage\">\n              <text class=\"record-mileage__value\">{{ entry.mileage }}</text>\n              <text class=\"record-mileage__unit\">公里</text>\n            </view>\n            <text\n              class=\"record-arrow iconfont icon-youjiantou\"\n              :class=\"{ 'record-arrow--expanded': isExpanded(entry.id) }\"\n            ></text>\n          </view>\n\n          <view class=\"record-details\" v-show=\"isExpanded(entry.id)\">\n            <!-- 2222-{{ isExpanded(entry.id) }} -->\n            <view class=\"record-meta\">\n              <text class=\"record-meta__value\">{{\n                entry.amount ? entry.amount + '元' : '--'\n              }}</text>\n              <text class=\"record-meta__value\">{{\n                entry.pricePerLiter ? entry.pricePerLiter + '元/升' : '--'\n              }}</text>\n              <text class=\"record-meta__value\">{{\n                entry.deltaFuel ? entry.deltaFuel + '升' : '--'\n              }}</text>\n            </view>\n            <view class=\"record-remark\">\n              <text class=\"record-remark__text\">\n                <text class=\"record-remark__oil\">{{\n                  entry.oilType || '--'\n                }}</text>\n                <text\n                  v-if=\"entry.fillStatus\"\n                  class=\"record-remark__status\"\n                  :class=\"{\n                    'record-remark__status--danger':\n                      entry.fillStatusTone === 'danger',\n                    'record-remark__status--accent':\n                      entry.fillStatusTone === 'accent',\n                  }\"\n                >\n                  {{ entry.fillStatus }}\n                </text>\n              </text>\n              <view class=\"record-edit\" @tap.stop=\"handleEdit(entry)\">✎</view>\n            </view>\n          </view>\n        </view>\n\n        <view\n          v-if=\"isRecordItem(entry) && isExpanded(entry.id)\"\n          :class=\"[\n            'comparison-card',\n            'comparison-card--success',\n            'list-animated',\n            { 'list-animated--visible': isPageAnimated },\n          ]\"\n          :style=\"getListAnimatedStyle(entryIndex, 'comparison')\"\n        >\n          <!-- 3333-{{ isExpanded(entry.id) }} -->\n          <view v-if=\"entry.consumption !== '--'\" class=\"comparison-value-box\">\n            <view class=\"comparison-value\">{{\n              entry.pricePerKm ? entry.pricePerKm + '元/公里' : '--'\n            }}</view>\n            <view class=\"comparison-value\">{{\n              entry.fuelConsumption ? entry.fuelConsumption + '升' : '--'\n            }}</view>\n            <view class=\"comparison-value\">{{\n              entry.deltaMileage ? entry.deltaMileage + '公里' : '--'\n            }}</view>\n            <text class=\"comparison-arrow iconfont icon-xiangyou\"></text>\n          </view>\n          <view v-else>\n            <text>需要加满两次，才能算出油耗</text>\n          </view>\n        </view>\n      </template>\n    </view>\n  </view>\n  <LoginOverlay v-model:visible=\"showLoginSheet\" />\n  <BottomActionBar\n    active=\"list\"\n    :is-logged-in=\"isLoggedIn\"\n    @login-required=\"handleLoginRequired\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { onShow } from '@dcloudio/uni-app';\nimport { computed, onMounted, onUnmounted, ref, watch } from 'vue';\nimport BottomActionBar from '@/components/BottomActionBar.vue';\nimport LoginOverlay from '@/components/LoginOverlay.vue';\nimport { useAuth } from '@/utils/auth';\nimport { axios } from '@/utils/request';\n\ntype FuelRecordItem = {\n  type: 'record';\n  id: string;\n  date: string;\n  week?: string;\n  consumption: string;\n  mileage: string;\n  amount?: string;\n  pricePerLiter?: string;\n  deltaFuel?: string;\n  oilType?: string;\n  fillStatus?: string;\n  fillStatusTone?: 'danger' | 'accent';\n  compact?: boolean;\n  highlight?: 'danger';\n  fuelConsumption?: string;\n  deltaMileage?: string;\n  pricePerKm?: string;\n};\n\ntype ComparisonItem = {\n  type: 'comparison';\n  id: string;\n  pricePerKm: string;\n  deltaFuel: string;\n  deltaMileage: string;\n  tone?: 'success';\n};\n\ntype FuelRecord = FuelRecordItem | ComparisonItem;\n\ntype SummarySnapshot = {\n  totalAmount: string;\n  avgFuel: string;\n  pricePerLiter: string;\n  mileage: string;\n};\n\nconst { isLoggedIn, refreshLoginState } = useAuth();\nconst showLoginSheet = ref(false);\n\n// ===== 年份筛选：默认“全部”，后端用 range=all =====\nconst yearOptions = ['全部', '2025', '2024', '2023'];\nconst selectedYearIndex = ref(0); // 默认选中“全部”\n\n// picker 显示的文字\nconst currentYear = computed(\n  () => yearOptions[selectedYearIndex.value] || '全部'\n);\n\n// 是否选中了“全部”\nconst isAllYear = computed(() => currentYear.value === '全部');\n\nconst summaryCard = ref<SummarySnapshot>({\n  totalAmount: '--',\n  avgFuel: '--',\n  pricePerLiter: '--',\n  mileage: '--',\n});\n\nconst records = ref<FuelRecordItem[]>([]);\n\nconst visibleRecords = computed(() => records.value);\n\nconst isPageAnimated = ref(false);\nlet enterAnimationTimer: ReturnType<typeof setTimeout> | null = null;\n\nconst runPageEnterAnimation = () => {\n  if (enterAnimationTimer) {\n    clearTimeout(enterAnimationTimer);\n    enterAnimationTimer = null;\n  }\n  isPageAnimated.value = false;\n  enterAnimationTimer = setTimeout(() => {\n    isPageAnimated.value = true;\n  }, 40);\n};\n\nconst getListAnimatedStyle = (\n  index: number,\n  variant: 'card' | 'comparison' = 'card'\n) => {\n  const limitedIndex = Math.min(index, 6);\n  const baseOffset = variant === 'comparison' ? 140 : 60;\n  return {\n    '--list-delay': `${limitedIndex * 70 + baseOffset}ms`,\n  };\n};\n\n// picker 改变年份\nconst handleYearChange = (event: { detail: { value: number } }) => {\n  selectedYearIndex.value = Number(event.detail.value);\n};\n\nconst isRecordItem = (entry: FuelRecord): entry is FuelRecordItem =>\n  entry.type === 'record';\n\nconst expandedRecordMap = ref<Record<string, boolean>>({});\n\nconst isExpanded = (id: string) => Boolean(expandedRecordMap.value[id]);\n\nconst toggleRecord = (entry: FuelRecordItem) => {\n  const next = {\n    ...expandedRecordMap.value,\n    [entry.id]: !expandedRecordMap.value[entry.id],\n  };\n  expandedRecordMap.value = next;\n};\n\n// ================== 核心：请求列表 ==================\nconst fetchRecords = async () => {\n  if (!isLoggedIn.value) {\n    records.value = [];\n    summaryCard.value = {\n      totalAmount: '--',\n      avgFuel: '--',\n      pricePerLiter: '--',\n      mileage: '--',\n    };\n    return;\n  }\n\n  try {\n    uni.showLoading({ title: '加载中...', mask: true });\n\n    // 前端筛选，接口始终取全部\n    const res = await axios.get(`/api/refuels/list?range=all`);\n    uni.__f__('log','at pages/records/index.vue:304','records res:', res);\n\n    if (!res || res.success !== true) {\n      throw new Error('接口返回异常');\n    }\n\n    const payload = res.data || {};\n    const list = (payload.records || []) as any[];\n    const currentYearNum = new Date().getFullYear();\n    const targetYearNum = Number(currentYear.value);\n\n    // 前端按年份过滤\n    const filteredList = list.filter((item) => {\n      if (isAllYear.value) return true;\n      const dateStr = item.date || item.refuelDate;\n      if (!dateStr) return false;\n      const parsed = new Date(String(dateStr).replace(/-/g, '/'));\n      if (Number.isNaN(parsed.getTime())) return false;\n      return parsed.getFullYear() === targetYearNum;\n    });\n\n    // 顶部 summary：基于筛选后的列表\n    const totalAmountNum = filteredList.reduce((sum, item) => {\n      const val = Number(item.amount);\n      return sum + (Number.isFinite(val) ? val : 0);\n    }, 0);\n\n    // ===== 平均油耗 avgFuel 计算 =====\n    let avgFuelNum: number | null = null;\n\n    if (isAllYear.value) {\n      // 「全部」：按你的新规则\n      // 列表是「最新在前」，所以索引越小越新，越大越旧\n      const consumptionIndexes: number[] = [];\n\n      filteredList.forEach((item, idx) => {\n        const c = item.consumption;\n        if (c === '--' || c == null) return;\n        const num = Number(c);\n        if (!Number.isFinite(num)) return;\n        consumptionIndexes.push(idx);\n      });\n\n      if (consumptionIndexes.length >= 2) {\n        // 第一条 & 最后一条（按当前列表顺序：最新在前）\n        const firstIdx = Math.min(...consumptionIndexes); // 列表中最靠前（最新）的那条\n        const lastIdx = Math.max(...consumptionIndexes); // 列表中最靠后（最旧）的那条\n\n        // 「最后一条 consumption 有值的下一条记录」\n        const nextIdx =\n          lastIdx + 1 < filteredList.length ? lastIdx + 1 : lastIdx;\n\n        const first = filteredList[firstIdx];\n        const nextAfterLast = filteredList[nextIdx];\n\n        const firstOdo = Number(first.odometer);\n        const nextOdo = Number(nextAfterLast.odometer);\n\n        let distance = NaN;\n        if (Number.isFinite(firstOdo) && Number.isFinite(nextOdo)) {\n          // 根据你的例子：1587 - 10\n          distance = firstOdo - nextOdo;\n        }\n\n        // 分子：从 firstIdx 到 lastIdx 之间（含）的 volume 之和\n        let volumeSum = 0;\n        for (let i = firstIdx; i <= lastIdx; i++) {\n          const v = Number(filteredList[i].volume);\n          if (Number.isFinite(v) && v > 0) {\n            volumeSum += v;\n          }\n        }\n\n        if (distance > 0 && volumeSum > 0) {\n          // L / 100km\n          avgFuelNum = (volumeSum / distance) * 100;\n        } else {\n          avgFuelNum = null;\n        }\n      } else {\n        // 有效 consumption 少于 2 条，没法算这种「区间油耗」\n        avgFuelNum = null;\n      }\n    } else {\n      // 非「全部」：按「consumption 求平均」来算\n      const consumptionValues = filteredList\n        .map((item) => item.consumption)\n        .filter((val) => val !== null && val !== '--')\n        .map((val) => Number(val))\n        .filter((val) => Number.isFinite(val));\n\n      if (consumptionValues.length > 0) {\n        const sum = consumptionValues.reduce((s, v) => s + v, 0);\n        avgFuelNum = sum / consumptionValues.length;\n      } else {\n        avgFuelNum = null;\n      }\n    }\n\n    // 平均油价 & 总里程仍按原来的方式\n    const pricePerLValues = filteredList\n      .map((item) => Number(item.pricePerL))\n      .filter((val) => Number.isFinite(val));\n    const avgPricePerLNum =\n      pricePerLValues.length > 0\n        ? pricePerLValues.reduce((s, v) => s + v, 0) / pricePerLValues.length\n        : null;\n\n    const totalDistanceNum = filteredList.reduce((sum, item) => {\n      const val = Number(item.distance);\n      return sum + (Number.isFinite(val) ? val : 0);\n    }, 0);\n\n    summaryCard.value = {\n      totalAmount: totalAmountNum > 0 ? totalAmountNum.toFixed(2) : '--',\n      avgFuel: avgFuelNum != null ? avgFuelNum.toFixed(2) : '--',\n      pricePerLiter:\n        avgPricePerLNum != null ? Number(avgPricePerLNum).toFixed(2) : '--',\n      mileage:\n        totalDistanceNum > 0 ? String(Math.round(totalDistanceNum)) : '--',\n    };\n\n    // 列表项映射到你现有的结构\n    records.value = filteredList.map((r): FuelRecordItem => {\n      const distanceNum = r.distance != null ? Number(r.distance) : NaN;\n      const volumeNum = r.volume != null ? Number(r.volume) : NaN;\n      const odometerNum = r.odometer != null ? Number(r.odometer) : NaN;\n      const rawDateStr = r.date || r.refuelDate || '';\n      let displayDate = r.monthDay || '--';\n      if (rawDateStr) {\n        const parsed = new Date(String(rawDateStr).replace(/-/g, '/'));\n        if (!Number.isNaN(parsed.getTime())) {\n          const y = parsed.getFullYear();\n          const m = String(parsed.getMonth() + 1).padStart(2, '0');\n          const d = String(parsed.getDate()).padStart(2, '0');\n          if (isAllYear.value && y !== currentYearNum) {\n            displayDate = `${y}/${m}/${d}`;\n          } else if (!r.monthDay) {\n            displayDate = `${m}-${d}`;\n          }\n        }\n      }\n\n      return {\n        type: 'record',\n        id: r._id,\n        date: displayDate,\n        consumption:\n          r.consumption != null ? Number(r.consumption).toFixed(2) : '--',\n        mileage: !Number.isNaN(odometerNum)\n          ? String(Math.round(odometerNum))\n          : '--',\n        amount: r.amount != null ? Number(r.amount).toFixed(2) : undefined,\n        pricePerLiter:\n          r.pricePerL != null ? Number(r.pricePerL).toFixed(2) : undefined,\n        deltaFuel: !Number.isNaN(volumeNum)\n          ? `+${volumeNum.toFixed(2)}`\n          : undefined,\n        oilType: r.fuelGrade ? `${r.fuelGrade}汽油` : undefined,\n        fillStatus: r.isFullTank ? '加满' : '',\n        fillStatusTone: r.isFullTank ? 'danger' : undefined,\n        compact: true,\n        highlight: undefined,\n        fuelConsumption: !Number.isNaN(volumeNum)\n          ? `-${volumeNum.toFixed(2)}`\n          : undefined,\n        deltaMileage: !Number.isNaN(distanceNum)\n          ? `+${Math.round(distanceNum)}`\n          : undefined,\n        pricePerKm:\n          r.pricePerKm != null ? Number(r.pricePerKm).toFixed(2) : undefined,\n      };\n    });\n  } catch (err) {\n    uni.__f__('error','at pages/records/index.vue:478','fetchRecords error:', err);\n    uni.showToast({\n      title: '加载失败，请稍后再试',\n      icon: 'none',\n    });\n  } finally {\n    uni.hideLoading();\n  }\n};\n\nconst handleLoginRequired = () => {\n  if (!isLoggedIn.value) {\n    showLoginSheet.value = true;\n  }\n};\n\n// 编辑记录\nconst handleEdit = (entry: FuelRecordItem) => {\n  handleLoginRequired();\n\n  uni.__f__('log','at pages/records/index.vue:498',590, 'handleEdit', entry);\n  uni.navigateTo({\n    url: `/pages/add/index?id=${entry.id}`,\n  });\n};\n\n// 切换年份时，重置展开状态 + 重新拉数据\nwatch(currentYear, () => {\n  expandedRecordMap.value = {};\n  runPageEnterAnimation();\n  fetchRecords();\n});\n\nonShow(() => {\n  refreshLoginState();\n  runPageEnterAnimation();\n  fetchRecords();\n});\n\n// 只做动画就行，不必再拉数据\nonMounted(() => {\n  runPageEnterAnimation();\n});\n\nonUnmounted(() => {\n  if (enterAnimationTimer) {\n    clearTimeout(enterAnimationTimer);\n    enterAnimationTimer = null;\n  }\n});\n</script>\n\n<style lang=\"scss\" scoped>\n@import '@/uni.scss';\n\n.records-page {\n  min-height: 100vh;\n  background: linear-gradient(180deg, #f8fbff 0%, #f2f4f9 100%);\n  padding: 24rpx 32rpx 180rpx;\n\n  .animated-block {\n    opacity: 0;\n    transform: translate3d(0, 40rpx, 0) scale(0.98);\n    transition-property: opacity, transform;\n    transition-duration: 0.55s, 0.65s;\n    transition-timing-function: ease, cubic-bezier(0.22, 0.61, 0.36, 1);\n    will-change: opacity, transform;\n  }\n\n  .animated-block--visible {\n    opacity: 1;\n    transform: translate3d(0, 0, 0) scale(1);\n  }\n\n  .animated-block--delay-0 {\n    transition-delay: 80ms;\n  }\n\n  .list-animated {\n    opacity: 0;\n    transform: translate3d(0, 32rpx, 0);\n    transition: opacity 0.45s ease,\n      transform 0.6s cubic-bezier(0.19, 1, 0.22, 1);\n    transition-delay: var(--list-delay, 0ms);\n    will-change: opacity, transform;\n  }\n\n  .list-animated--visible {\n    opacity: 1;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .summary-panel {\n    position: relative;\n    overflow: hidden;\n    padding: 32rpx;\n    margin-bottom: 32rpx;\n    border-radius: 32rpx;\n    // background: linear-gradient(110deg, #cde6ff, #dfeeff 70%);\n    background: linear-gradient(135deg, #ede6ff 0%, #f4f1ff 55%, #e9fdf2 100%);\n    box-shadow: 0 20rpx 40rpx rgba(0, 83, 156, 0.1);\n\n    &::before,\n    &::after {\n      content: '';\n      position: absolute;\n      inset: 0;\n      pointer-events: none;\n    }\n\n    &::before {\n      background: radial-gradient(\n          circle at 0% 0%,\n          rgba(255, 255, 255, 0.7),\n          transparent 45%\n        ),\n        radial-gradient(\n          circle at 100% 20%,\n          rgba(255, 255, 255, 0.35),\n          transparent 40%\n        );\n      opacity: 0.65;\n      mix-blend-mode: screen;\n      animation: summaryGlow 12s ease-in-out infinite alternate;\n    }\n\n    &::after {\n      background: linear-gradient(\n        120deg,\n        rgba(255, 255, 255, 0) 0%,\n        rgba(255, 255, 255, 0.5) 45%,\n        rgba(255, 255, 255, 0) 80%\n      );\n      transform: translateX(-60%);\n      animation: summarySweep 6s linear infinite;\n      opacity: 0.4;\n    }\n\n    .summary-panel__bg {\n      position: absolute;\n      width: 200rpx;\n      height: 200rpx;\n      border-radius: 50%;\n      background: rgba(255, 255, 255, 0.3);\n      filter: blur(0.5px);\n    }\n\n    .summary-panel__bg--left {\n      top: -40rpx;\n      left: -40rpx;\n    }\n\n    .summary-panel__bg--right {\n      bottom: -60rpx;\n      right: -20rpx;\n    }\n\n    .summary-head {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 24rpx;\n      position: relative;\n      z-index: 1;\n    }\n\n    .summary-picker {\n      // width: 260rpx;\n    }\n\n    .summary-year {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 8rpx;\n      padding: 10rpx 18rpx;\n      border-radius: 30rpx;\n      border: 2rpx solid rgba(255, 255, 255, 0.6);\n      color: #1f2329;\n      font-size: 26rpx;\n      font-weight: 600;\n      background: rgba(255, 255, 255, 0.6);\n\n      .icon-youjiantou {\n        font-size: 18rpx;\n        transform: rotate(90deg);\n        margin-top: 6rpx;\n      }\n    }\n\n    .summary-chip {\n      padding: 10rpx 20rpx;\n      border-radius: 30rpx;\n      font-size: 24rpx;\n      color: #1f2329;\n      background: rgba(255, 255, 255, 0.7);\n    }\n\n    .summary-total {\n      position: relative;\n      z-index: 1;\n      margin-bottom: 28rpx;\n\n      .summary-total__value {\n        font-size: 48rpx;\n        font-weight: 700;\n      }\n\n      .summary-total__label {\n        display: block;\n        font-size: 24rpx;\n        color: rgba(10, 41, 90, 0.7);\n      }\n    }\n\n    .summary-grid {\n      display: flex;\n      justify-content: space-between;\n      position: relative;\n      z-index: 1;\n\n      .summary-stat {\n        flex: 1;\n        color: #1f2329;\n\n        .summary-stat__label {\n          display: block;\n          font-size: 24rpx;\n          opacity: 0.8;\n        }\n\n        .summary-stat__value {\n          display: block;\n          font-size: 28rpx;\n          font-weight: 600;\n        }\n      }\n\n      .summary-stat:not(:last-child) {\n        border-right: 2rpx solid rgba(255, 255, 255, 0.4);\n        margin-right: 16rpx;\n        padding-right: 16rpx;\n      }\n    }\n  }\n\n  .records-list {\n    display: flex;\n    flex-direction: column;\n    gap: 20rpx;\n\n    .record-card {\n      background: #fff;\n      border-radius: 28rpx;\n      padding: 28rpx;\n      box-shadow: 0 12rpx 30rpx rgba(15, 114, 59, 0.08);\n      transition: box-shadow 0.35s ease, transform 0.35s ease;\n      position: relative;\n      overflow: hidden;\n      border: 1rpx solid rgba(15, 114, 59, 0.1);\n\n      &::before,\n      &::after {\n        content: '';\n        position: absolute;\n        inset: 0;\n        pointer-events: none;\n        border-radius: inherit;\n      }\n\n      &::before {\n        background: linear-gradient(\n          135deg,\n          rgba(64, 160, 255, 0.08),\n          rgba(30, 193, 95, 0.12)\n        );\n        opacity: 0;\n        transition: opacity 0.35s ease;\n      }\n\n      &::after {\n        inset: -60% -30% auto -30%;\n        height: 140rpx;\n        background: linear-gradient(\n          180deg,\n          rgba(255, 255, 255, 0),\n          rgba(255, 255, 255, 0.55),\n          rgba(255, 255, 255, 0)\n        );\n        transform: translate3d(0, -50%, 0) rotate(-8deg);\n        animation: cardShimmer 7s linear infinite;\n        opacity: 0.2;\n      }\n\n      .record-card__top {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        // gap: 24rpx;\n\n        .record-date {\n          flex: 1;\n          position: relative;\n          padding-left: 20rpx;\n\n          .record-date__value {\n            font-size: 32rpx;\n            // font-weight: 700;\n          }\n          center .record-date__week {\n            display: block;\n            font-size: 22rpx;\n            color: $muted-text;\n          }\n        }\n\n        .record-date::before {\n          content: '';\n          position: absolute;\n          left: 0;\n          top: 8rpx;\n          width: 6rpx;\n          height: 32rpx;\n          border-radius: 4rpx;\n          background: linear-gradient(180deg, #00a3ff, #4bc9ff);\n        }\n\n        .record-consumption {\n          flex: 1;\n          // display: flex;\n          // align-items: flex-end;\n          gap: 12rpx;\n\n          .record-consumption__value {\n            font-size: 40rpx;\n            font-weight: 600;\n            color: $primary-dark;\n          }\n          .record-consumption__value--high {\n            color: #ff4b46;\n          }\n\n          .record-consumption__unit {\n            font-size: 22rpx;\n            color: $muted-text;\n          }\n        }\n\n        .record-mileage {\n          // flex: 1;\n          margin-left: 30rpx;\n          // text-align: right;\n\n          .record-mileage__value {\n            font-size: 40rpx;\n            font-weight: 600;\n          }\n\n          .record-mileage__unit {\n            // display: block;\n            margin-left: 12rpx;\n            font-size: 22rpx;\n            color: $muted-text;\n          }\n        }\n\n        .record-arrow {\n          font-size: 20rpx;\n          color: $muted-text;\n          padding-left: 12rpx;\n          display: inline-block;\n          transition: transform 0.2s ease;\n          margin-top: 16rpx;\n          transform-origin: center;\n        }\n\n        .record-arrow--expanded {\n          transform: rotate(90deg);\n          margin-top: 0;\n        }\n      }\n\n      .record-details {\n        margin-top: 20rpx;\n        padding: 24rpx;\n        border-radius: 20rpx;\n        background: #fff;\n        border: 2rpx solid rgba(31, 35, 41, 0.06);\n\n        .record-meta {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 20rpx;\n          gap: 12rpx;\n\n          .record-meta__value {\n            flex: 1;\n            text-align: left;\n            font-size: 26rpx;\n            font-weight: 600;\n            color: #1f2329;\n            white-space: nowrap;\n          }\n        }\n\n        .record-remark {\n          margin-top: 8rpx;\n          display: flex;\n          justify-content: space-between;\n          align-items: flex-start;\n\n          .record-remark__text {\n            font-size: 26rpx;\n            color: #1f2329;\n            display: flex;\n            align-items: center;\n            gap: 12rpx;\n          }\n\n          .record-remark__oil {\n            font-weight: 600;\n            color: #1f2329;\n          }\n\n          .record-remark__status {\n            font-weight: 600;\n            margin-left: 12rpx;\n          }\n\n          .record-remark__status--danger {\n            color: #ff4b46;\n          }\n\n          .record-remark__status--accent {\n            color: $primary-dark;\n          }\n\n          .record-edit {\n            width: 44rpx;\n            height: 44rpx;\n            border-radius: 14rpx;\n            background: rgba(30, 193, 95, 0.12);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 28rpx;\n            color: #1ec15f;\n            font-weight: 600;\n            align-self: flex-end;\n          }\n        }\n      }\n    }\n\n    .record-card--compact {\n      padding: 24rpx;\n    }\n\n    .record-card--expanded {\n      transform: translateY(-6rpx);\n      box-shadow: 0 18rpx 46rpx rgba(13, 102, 53, 0.18);\n\n      &::before {\n        opacity: 1;\n      }\n    }\n\n    .record-card__hover {\n      background: #fefefe;\n    }\n\n    .record-card--alert {\n      .record-consumption__value {\n        color: #ff4b46;\n      }\n      .record-consumption__value--high {\n        color: #ff4b46;\n      }\n    }\n\n    .comparison-card {\n      background: #f5fbf6;\n      border-radius: 28rpx;\n      padding: 26rpx;\n\n      border: 2rpx solid rgba(30, 193, 95, 0.1);\n      position: relative;\n      overflow: hidden;\n      transition: box-shadow 0.3s ease;\n\n      &::after {\n        content: '';\n        position: absolute;\n        inset: 0;\n        background: linear-gradient(\n          90deg,\n          rgba(255, 255, 255, 0.1),\n          rgba(255, 255, 255, 0)\n        );\n        animation: comparisonSweep 6s linear infinite;\n        opacity: 0.6;\n        pointer-events: none;\n      }\n      .comparison-value-box {\n        display: flex;\n        align-items: center;\n        gap: 16rpx;\n        .comparison-value {\n          flex: 1;\n          font-size: 28rpx;\n          font-weight: 600;\n          color: #1f2329;\n          text-align: center;\n        }\n\n        .comparison-arrow {\n          font-size: 26rpx;\n          color: $muted-text;\n        }\n      }\n    }\n\n    .comparison-card--success {\n      background: rgba(30, 193, 95, 0.12);\n      border-color: rgba(30, 193, 95, 0.3);\n      box-shadow: 0 18rpx 36rpx rgba(30, 193, 95, 0.18);\n    }\n  }\n}\n\n@keyframes summaryGlow {\n  0% {\n    transform: scale(1);\n    opacity: 0.4;\n  }\n  100% {\n    transform: scale(1.04);\n    opacity: 0.7;\n  }\n}\n\n@keyframes summarySweep {\n  0% {\n    transform: translateX(-80%);\n  }\n  100% {\n    transform: translateX(120%);\n  }\n}\n\n@keyframes cardShimmer {\n  0% {\n    transform: translate3d(-20%, -50%, 0) rotate(-8deg);\n    opacity: 0;\n  }\n  40% {\n    opacity: 0.25;\n  }\n  100% {\n    transform: translate3d(140%, -50%, 0) rotate(-8deg);\n    opacity: 0;\n  }\n}\n\n@keyframes comparisonSweep {\n  0% {\n    transform: translateX(-120%);\n  }\n  100% {\n    transform: translateX(120%);\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/alan2/Downloads/zm/cat-life-uniapp-wechat/pages/records/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useAuth","ref","computed","uni","axios","watch","onShow","onMounted","onUnmounted"],"mappings":"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"}